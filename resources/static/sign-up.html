<!DOCTYPE html>
<html>
<head>
	<title>Sign-up to Postr</title>
	<style type="text/css">
		div {
			box-sizing: border-box;
			margin: 1%;
		}
		
		input:invalid {
  			border: 1px dashed red;
		}

		input {
			border: default;
		}
	</style>
</head>
<body>
	<form class="sign-up" method="post" action="http://localhost:8080/signed-up">
		<div class="email">
			<label for="emailId">Enter your email address</label><br>
			<input type="email" id= 'email' name="Email Id" autofocus placeholder="Email address" required onchange="check_email()">
		</div>
		<div class="password">
			<label for="password">Enter a password</label><br>
			<input type="password" id="password" name="" ="password" placeholder="Password" maxlength="16" onkeyup="check_pass()" required>
		</div>
		<div class="confirm-password">
			<label for="confirm-password">Confirm password</label><br>
			<input type="password" id="confirm-password" name="confirm-password" placeholder="Re-enter password" maxlength="16" onkeyup="check_pass()" required>
		</div>
		<div>
			<button type="sign-up">Sign-up</button>
		</div>
	</form>
	<script type="text/javascript">
		const email = document.getElementById('email')
		const password = document.getElementById('password')
		const confirmPassword = document.getElementById('confirm-password')
		const btn = document.querySelector('button')

		function check_pass() {
    		if (password.value ===
            confirmPassword.value) {
        		btn.disabled = false;
    		} else {
        		btn.disabled = true;
    		}
		}

		function check_email() {
			fetch('check-email', {
				'method': 'POST',
				'headers': {
					'Content-Type': 'application/json'
				},
				'body': JSON.stringify({'email': email.value})
			}).then((response) => response.json()).then((data) => {
				if (data === true) {
					email.placeholder="Email already in use"
					email.focus()
				} else {
					password.focus()
				}
			})
		}
	</script>
</body>
</html>